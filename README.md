# Rway
Добавляю сюда полезные скрипты написанные для выполнения и упрощения некоторых функций,которые необходимо выполнять в RWAY.

# Current SCREEN instructions
Данная скрипта берет 2 файла, проверка актуальности по сайтам и проверку аткуальности по скринам,
для каждого источника сравнивает  значения регулярок (и отрицательных и положительных), в случае если регулярки
для источников разные,  заменяет регулярки скринов  регулярками для сайтов и записывает новый файл "Новые скрены". 

# Parsing_verification
Скрипт предназначен для  получения оценочных данных результатов парсинга. конкретного ЗАДАНИЯ из базы данных RWAY.

# geocode
Скрипт, берет список  городов полученный из файла, передает их в Яндекс АПИ. Яндекс возвращает субъект. Далее в субъекте от яндекса ищется слово  по ключу словаря 1С RWAY. Результат = строка для шаблона 1с в терминал.

# Download from ftp
Простой скрипт скачивания файлов  с фтп для визуальной проверки скриншотов. Для каждого источника скачивается 3 файла. Сохраняется все в одну папку или персональную для каждого источника.

# excel_to_word
Скрипт заполняет таблицы ворд файла данными из эксель файла. Строгое соответствие шаблона таблиц Ворд файла и таблиц эксель файла согласно образцам в соответствующих папках DOCX и EXCEL. Оснавная задача скрипта, это заполнить Ворд таблицы данными из эксель так, чтобы форматирование таблицы, выравнивание текста, размер шрифта и тд. строго соответствовало шаблону Ворд Файла. (полезная ссылка http://ilnurgi1.ru/docs/python/modules_user/docx.html)
![Image alt](https://github.com/FF7FSystem/Rway/blob/master/excel_to_word/excel_to_word_2.png)

# design_price
Скрипт  загружает эксель файл, ищет в нем отдельные таблицы (по ключевому слову). В каждой таблице обрезает лишние, форматирует и возвращает в виде словаря где ключ: название таблицы, значение таблица (Датафрейм).

# parsing_monitor
На локальном сервере (host='0.0.0.0',port='5000') разворачивается web приложение, отображающее статистические данные по  последнему созданному заданию (далее Текущему) парсинга в 1С Rrway. Приложение «создает» страничку, с 5 вкладками. 

Вкладка №1 «Скорость парсинга каждого источника», отображает графики динамики парсинга источников  по Текущему заданию.
![Image alt](https://github.com/FF7FSystem/Rway/tree/master/parsing_monitor/tab_1.png)

Вкладка №2 «Результаты парсинга по каждому источнику на данный момент», отображает графики сбора предложений  (характеристика «Всего предложений») по каждому источнику Текущего задания в сравнении с средним и медианным значением ранее полученных соответствующих данных .
![Image alt](https://github.com/FF7FSystem/Rway/tree/master/parsing_monitor/tab_2.png)

Вкладка №3 «Характеристика «Всего предложений» по каждому источнику за период (ранее спарсиные данные + данные Текущего задания).
![Image alt](https://github.com/FF7FSystem/Rway/tree/master/parsing_monitor/tab_3.png)

Вкладка №4 «Статистические данные по Текущему заданию». Контент таблиц формируется на основании SQL запроса в базу данных с последующей обработкой. Возможна загрузка свежих статистических данных по нажатию на кнопку «Загрузить». 
![Image alt](https://github.com/FF7FSystem/Rway/tree/master/parsing_monitor/tab_4.png)

Вкладка №5 «Произвольное задание» . Позволяет отобразить статистические данные по произвольному заданию спарсиного ранее и записанного в папку «parse_result» в соответствующем формате.
![Image alt](https://github.com/FF7FSystem/Rway/tree/master/parsing_monitor/tab_5.png)

Упрощенная схема работы приложений описана в следующей схеме.
![Image alt](https://github.com/FF7FSystem/Rway/tree/master/parsing_monitor/Chema.png)
При создании нового задания парсинга приложение обновляет данные.
